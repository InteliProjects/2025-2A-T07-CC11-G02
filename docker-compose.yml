services:
  backend:
    build:
      context: .
      target: backend
    ports:
      - "8000:8000"
    environment:
      - PYTHONUNBUFFERED=1
      - HF_HUB_OFFLINE=0
      - TRANSFORMERS_OFFLINE=0
      - HF_HUB_CACHE=/app/cache
      - HF_TOKEN=${HF_TOKEN}
      - HUGGINGFACE_HUB_TOKEN=${HF_TOKEN}
    volumes:
      - hf_cache:/app/cache
    dns:
      - "8.8.8.8"
      - "8.8.4.4"

  frontend:
    build:
      context: .
      target: frontend
    ports:
      - "5173:5173"
    depends_on:
      - backend

volumes:
  hf_cache:
